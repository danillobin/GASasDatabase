class GASDasDatabase{constructor(a){this.folder=DriveApp.getFoldersByName(a),this.folder.hasNext()?this.folder=this.folder.next():this.folder=DriveApp.createFolder(a)}clearBase(){let a=this.folder.getFiles();for(;a.hasNext();)a.next().setTrashed(!0)}deleteBase(){for(let[a,b]of(this.folder.setTrashed(!0),Object.entries(this)))delete this[a]}getRandomInt(a,b){return a=Math.ceil(a),b=Math.floor(b),Math.floor(Math.random()*(b-a))+a}dataToObject(b,c,d){let a={};return a.id=c,a.post=b,a.value=d,a}createPost(b="",a="",d=MimeType.PLAIN_TEXT){b=JSON.stringify(b),a=a||Utilities.base64Encode(new Date().valueOf())+this.getRandomInt(1e5,999999);let c=this.folder.createFile(a,b,d);return this.dataToObject(c,a,this.getValue(c))}deletePost(a){return a.setTrashed(!0)}searchPosts(d){let b=this.folder.searchFiles(d),c=[];for(;b.hasNext();){let a=b.next();c.push(this.dataToObject(a,a.getName(),this.getValue(a)))}return c}getValue(b){let a=b.getBlob().getDataAsString();return a&&(a=JSON.parse(a)),a}setValue(a,b){return a=JSON.stringify(a),b.setContent(a)}getPosts(a=[]){let b="";return a.forEach(function(e,f){let c="";for(let[g,h]of Object.entries(e)){let d=`fullText contains '${g}:${h}'`;c+=c?" and "+d:d}a.length>1?b+=f+1!=a.length?`(${c}) or `:`(${c})`:b=c}),this.searchPosts(b)}}
